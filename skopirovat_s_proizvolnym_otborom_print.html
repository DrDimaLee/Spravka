<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
	<head>
		<base target="_blank" />
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<link href="css/printed.css" media="all" rel="StyleSheet" type="text/css" />
		<link href="de_style.css" media="all" rel="StyleSheet" type="text/css" />
		<meta name="generator" content="www.DrExplain.com" />
				<title>1.1.1.5. &#x0421;&#x043A;&#x043E;&#x043F;&#x0438;&#x0440;&#x043E;&#x0432;&#x0430;&#x0442;&#x044C; &#x0441; &#x043F;&#x0440;&#x043E;&#x0438;&#x0437;&#x0432;&#x043E;&#x043B;&#x044C;&#x043D;&#x044B;&#x043C; &#x043E;&#x0442;&#x0431;&#x043E;&#x0440;&#x043E;&#x043C;</title>
	</head>
	<body>
		<table class="pagetable">
			<tr class="page" style="border-color: #ffffff;">
				<td class="page_area" style="border-color: #ffffff; width: 100%;"><div class="description_on_page"><div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><div class="ic"><h1><strong>1.1.1.5. Скопировать с произвольным отбором</strong></h1></div></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_45105D3361"><strong>Скопировать ТЗ с произвольным отбором данных</strong></span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;">&#160;</div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_4AF4BF9DD6">ПостроительЗапроса = Новый ПостроительЗапроса;</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_4AF4BF9DD6"> </span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_4AF4BF9DD6">ПостроительЗапроса.ИсточникДанных = Новый ОписаниеИсточникаДанных(ТаблицаДанных);//ТаблицаДанных - это таблица значений</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_4AF4BF9DD6">НовыйОтбор = ПостроительЗапроса.Отбор.Добавить(&quot;ФизическоеЛицо&quot;); </span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_4AF4BF9DD6">НовыйОтбор.ВидСравнения = ВидСравнения.Равно;// нужный вид сравнения </span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_4AF4BF9DD6">НовыйОтбор.Значение = ЭлементТаблицыФизическихЛиц.ФизическоеЛицо;//конкретное физическое лицо  </span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_4AF4BF9DD6">НовыйОтбор.Использование = Истина;</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_4AF4BF9DD6"> </span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_4AF4BF9DD6">Если НеУчитыватьПустыеОтметкиПриРасчетеСредней Тогда</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_4AF4BF9DD6">НовыйОтбор1 = ПостроительЗапроса.Отбор.Добавить(&quot;Отметка&quot;);</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_4AF4BF9DD6">НовыйОтбор1.ВидСравнения = ВидСравнения.НеРавно;// нужный вид сравнения, если ВСпике, то требуется тип <strong>СписокЗначений</strong></span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_4AF4BF9DD6">НовыйОтбор1.Значение = Справочники.Отметки.ПустаяСсылка();</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_4AF4BF9DD6">НовыйОтбор1.Использование = Истина;</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_4AF4BF9DD6">КонецЕсли;</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_4AF4BF9DD6"> </span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_4AF4BF9DD6">Результат = ПостроительЗапроса.Результат;// отобранные строки типа РезультатЗапроса </span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_4AF4BF9DD6">   </span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_4AF4BF9DD6">РезультатФизическоеЛицо = Результат.Выгрузить();</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;">&#160;</div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_5A562E478A">//Dr 02032021</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_5A562E478A">Функция ОтчисленныеПоФакультетам(ТаблицаДанных, ЗначенияОтбора)</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_5A562E478A">&#160;&#160; &#160; ПостроительЗапроса = Новый ПостроительЗапроса;</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_5A562E478A">&#160;&#160; &#160; ПостроительЗапроса.ИсточникДанных = Новый ОписаниеИсточникаДанных(ТаблицаДанных);</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_5A562E478A">&#160;&#160; &#160; НовыйОтбор = ПостроительЗапроса.Отбор.Добавить(&quot;Факультет&quot;); </span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_5A562E478A">&#160;&#160; &#160; Если ТипЗнч(ЗначенияОтбора) = Тип(&quot;Массив&quot;) Тогда</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_5A562E478A">&#160; &#160; &#160; &#160; &#160; СписокЗначений = Новый СписокЗначений;</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_5A562E478A">&#160; &#160; &#160; &#160; &#160; СписокЗначений.ЗагрузитьЗначения(ЗначенияОтбора);</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_5A562E478A">&#160; &#160; &#160; &#160; &#160; НовыйОтбор.ВидСравнения = ВидСравнения.ВСписке;</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_5A562E478A">&#160; &#160; &#160; &#160; &#160; НовыйОтбор.Значение = СписокЗначений;</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_5A562E478A">&#160;&#160; &#160; Иначе</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_5A562E478A">&#160; &#160; &#160; &#160; &#160; НовыйОтбор.ВидСравнения = ВидСравнения.Равно;</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_5A562E478A">&#160; &#160; &#160; &#160; &#160; НовыйОтбор.Значение = ЗначенияОтбора;</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_5A562E478A">&#160;&#160; &#160; КонецЕсли; &#160; &#160; </span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_5A562E478A">&#160;&#160; &#160; НовыйОтбор.Использование = Истина;</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_5A562E478A">&#160;&#160; &#160; Результат = ПостроительЗапроса.Результат;</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_5A562E478A">&#160;&#160; &#160; Возврат Результат.Выгрузить();</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_5A562E478A">КонецФункции &#160; &#160; </span></div>
</div>				</td>
			</tr>
		</table>
	</body>
</html>