<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
	<head>
		<base target="_blank" />
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<link href="css/printed.css" media="all" rel="StyleSheet" type="text/css" />
		<link href="de_style.css" media="all" rel="StyleSheet" type="text/css" />
		<meta name="generator" content="www.DrExplain.com" />
				<title>1.1.1.6.1. &#x041F;&#x0440;&#x043E;&#x0441;&#x0442;&#x043E;&#x0439; &#x0442;&#x0440;&#x044E;&#x043A; &#x0434;&#x043B;&#x044F; &#x0431;&#x044B;&#x0441;&#x0442;&#x0440;&#x043E;&#x0433;&#x043E; &#x043E;&#x0431;&#x044A;&#x0435;&#x0434;&#x0438;&#x043D;&#x0435;&#x043D;&#x0438;&#x044F; &#x0442;&#x0430;&#x0431;&#x043B;&#x0438;&#x0446; &#x0437;&#x043D;&#x0430;&#x0447;&#x0435;&#x043D;&#x0438;&#x0439;</title>
	</head>
	<body>
		<table class="pagetable">
			<tr class="page" style="border-color: #ffffff;">
				<td class="page_area" style="border-color: #ffffff; width: 100%;"><div class="description_on_page"><div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><div class="ic"><h1><strong>1.1.1.6.1. Простой трюк для быстрого объединения таблиц значений</strong></h1></div></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 3px; text-indent: 0px;">&#160;</div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 3px; text-indent: 0px;"><span class="de_5FBF8EB62F">Опубликовано </span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 3px; text-indent: 0px;"><a href="http://www.gilev.ru/%d0%bf%d1%80%d0%be%d1%81%d1%82%d0%be%d0%b9-%d1%82%d1%80%d1%8e%d0%ba-%d0%b4%d0%bb%d1%8f-%d0%b1%d1%8b%d1%81%d1%82%d1%80%d0%be%d0%b3%d0%be-%d0%be%d0%b1%d1%8a%d0%b5%d0%b4%d0%b8%d0%bd%d0%b5%d0%bd%d0%b8/"><span class="de_8FA7093FD4"><strong>01.03.2016</strong></span></a></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 3px; text-indent: 0px;"><span class="de_5FBF8EB62F"> автором </span><a href="http://www.gilev.ru/author/admin/"><span class="de_8FA7093FD4"><strong>admin</strong></span></a></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><table class="de_tbl_1794 detbl" style="width: 1794px; height: 0; margin-left: 0; margin-right: auto;">
<col style="width: 1794px;" class="de_col_1_1794" />
<tr style="height: 0px;">
<td class="de_td_1794" style = "padding: 2px; padding-bottom: 1px; border-left-style: none; border-left-width: 0px; border-left-color: #4d4d4d; border-right-style: none; border-right-width: 0px; border-right-color: #4d4d4d; border-top-style: none; border-top-width: 0px; border-top-color: #4d4d4d; border-bottom-style: none; border-bottom-width: 0px; border-bottom-color: #4d4d4d;  width: 1794px; vertical-align: top; background-color: #ffffff;" colspan = "1" rowspan = "1" >
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_134D85FD9B">Стандартный способ объединения двух таблиц значений заключается в организации цикла, в котором строки второй таблицы приписываются в конец копии первой. Для этого используется следующий простой код:</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_B0B5DD9A7A">ОбъединениеТаблиц</span><span class="de_134D85FD9B"> </span><span class="de_AE43A86E79">=</span><span class="de_134D85FD9B"> </span><span class="de_B0B5DD9A7A">Таблица1</span><span class="de_AE43A86E79">.</span><span class="de_B0B5DD9A7A">Скопировать</span><span class="de_AE43A86E79">();</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_AE43A86E79">Для</span><span class="de_134D85FD9B"> </span><span class="de_AE43A86E79">Каждого</span><span class="de_134D85FD9B"> </span><span class="de_B0B5DD9A7A">Строка</span><span class="de_134D85FD9B"> </span><span class="de_AE43A86E79">Из</span><span class="de_134D85FD9B"> </span><span class="de_B0B5DD9A7A">Таблица2</span><span class="de_134D85FD9B"> </span><span class="de_AE43A86E79">Цикл</span><span class="de_134D85FD9B"> </span><span class="de_B0B5DD9A7A">ЗаполнитьЗначенияСвойств</span><span class="de_AE43A86E79">(</span><span class="de_B0B5DD9A7A">ОбъединениеТаблиц</span><span class="de_AE43A86E79">.</span><span class="de_B0B5DD9A7A">Добавить</span><span class="de_AE43A86E79">(),</span><span class="de_134D85FD9B"> </span><span class="de_B0B5DD9A7A">Строка</span><span class="de_AE43A86E79">)</span><span class="de_134D85FD9B"> </span><span class="de_AE43A86E79">КонецЦикла</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_134D85FD9B">Все возможности оптимизация данного способа ограничиваются записью в одну строку и выбором таблицы с меньшим количеством элементов в качестве источника добавляемых строк.</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_134D85FD9B">Предлагаемый трюк заключается в последовательном выполнении трех действий:</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_134D85FD9B">1)      Вторая (добавляемая) таблица копируется в таблицу-результат;</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_134D85FD9B">2)      В начало таблицы результата перед уже скопированной таблицей вставляется столько пустых строк, сколько строк в первой таблице. Таким образом «освобождается место» для первой таблицы;</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_134D85FD9B">3)      Затем первая таблица помещается на освобожденное место методом выгрузки-загрузки колонок.  Фокус в том, что при загрузке колонки в таблицу значений, если загружаемая колонка короче целевой, то оставшиеся элементы целевой колонки не меняются.</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_134D85FD9B">Схематичное описание той же последовательности действий приведено на рисунке ниже</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 6px; text-indent: 0px;"><a href="http://www.gilev.ru/wp-content/uploads/2016/03/%D0%A1%D1%85%D0%B5%D0%BC%D0%B0.png"><span class="de_F2A5DDF7C0"><img  alt="" style="border: solid 0px;  " width="706" height="424" class=" de_780D01ADE8" src="drex_prostoj_tryuk_dlya_bystrogo_obedineniya_tablits_znachenij_custom.png"/></span></a></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_134D85FD9B">Реализация предложенного способа очень проста и выполняется следующим фрагментом программного кода:</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_B0B5DD9A7A">ОбъединениеТаблиц</span><span class="de_134D85FD9B"> </span><span class="de_AE43A86E79">=</span><span class="de_134D85FD9B"> </span><span class="de_B0B5DD9A7A">Таблица2</span><span class="de_AE43A86E79">.</span><span class="de_B0B5DD9A7A">Скопировать</span><span class="de_AE43A86E79">();</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_AE43A86E79">Для</span><span class="de_134D85FD9B"> ё </span><span class="de_AE43A86E79">=</span><span class="de_134D85FD9B"> 1 </span><span class="de_AE43A86E79">По</span><span class="de_134D85FD9B"> </span><span class="de_B0B5DD9A7A">Таблица1</span><span class="de_AE43A86E79">.</span><span class="de_B0B5DD9A7A">Количество</span><span class="de_AE43A86E79">()</span><span class="de_134D85FD9B"> </span><span class="de_AE43A86E79">Цикл</span><span class="de_134D85FD9B"> </span><span class="de_B0B5DD9A7A">ОбъединениеТаблиц</span><span class="de_AE43A86E79">.</span><span class="de_B0B5DD9A7A">Вставить</span><span class="de_AE43A86E79">(</span><span class="de_134D85FD9B">0</span><span class="de_AE43A86E79">)</span><span class="de_134D85FD9B"> </span><span class="de_AE43A86E79">КонецЦикла;</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_AE43A86E79">Для</span><span class="de_134D85FD9B"> ё </span><span class="de_AE43A86E79">=</span><span class="de_134D85FD9B"> 0 </span><span class="de_AE43A86E79">По</span><span class="de_134D85FD9B"> </span><span class="de_B0B5DD9A7A">Таблица1</span><span class="de_AE43A86E79">.</span><span class="de_B0B5DD9A7A">Колонки</span><span class="de_AE43A86E79">.</span><span class="de_B0B5DD9A7A">Количество</span><span class="de_AE43A86E79">()</span><span class="de_134D85FD9B"> </span><span class="de_AE43A86E79">—</span><span class="de_134D85FD9B"> 1 </span><span class="de_AE43A86E79">Цикл</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_B0B5DD9A7A">ОбъединениеТаблиц</span><span class="de_AE43A86E79">.</span><span class="de_B0B5DD9A7A">ЗагрузитьКолонку</span><span class="de_AE43A86E79">(</span><span class="de_B0B5DD9A7A">Таблица1</span><span class="de_AE43A86E79">.</span><span class="de_B0B5DD9A7A">ВыгрузитьКолонку</span><span class="de_AE43A86E79">(</span><span class="de_134D85FD9B">ё</span><span class="de_AE43A86E79">),</span><span class="de_134D85FD9B"> ё</span><span class="de_AE43A86E79">)</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_AE43A86E79">КонецЦикла;</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_134D85FD9B">Колонок в таблицах значений обычно всегда значительно меньше, чем строк. Поэтому такой способ содержит меньше отдельных действий и в результате выполняется платформой быстрее построчного копирования. Ускорение зависит от соотношения числа строк и столбцов и может достигать полутора раз.</span></div>
</td></tr></table></div>
</div>				</td>
			</tr>
		</table>
	</body>
</html>